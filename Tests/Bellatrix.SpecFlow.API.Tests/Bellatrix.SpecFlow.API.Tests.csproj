<Project Sdk="Microsoft.NET.Sdk">

    <PropertyGroup>
        <TargetFramework>net5.0</TargetFramework>
        <LangVersion>9.0</LangVersion>
        <IsPackable>false</IsPackable>
        <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
        <Configurations>Debug;Release;ObfuscatedNuGets</Configurations>
        <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
        <RunAnalyzersDuringBuild>true</RunAnalyzersDuringBuild>
        <RunAnalyzersDuringLiveAnalysis>true</RunAnalyzersDuringLiveAnalysis>
        <RunAnalyzers>true</RunAnalyzers>
        <TreatWarningsAsErrors>true</TreatWarningsAsErrors>
        <WarningsAsErrors />
        <NoWarn>NU1701;NU1702;NU1705;</NoWarn>
    </PropertyGroup>

    <PropertyGroup>
        <CodeAnalysisRuleSet>..\StyleCopeRules.ruleset</CodeAnalysisRuleSet>
    </PropertyGroup>

    <ItemGroup>
        <AdditionalFiles Include="..\stylecop.json" Link="stylecop.json" />
    </ItemGroup>

    <ItemGroup>
        <PackageReference Include="Bellatrix.API.DemoApps" Version="1.3.0" />
        <PackageReference Include="Microsoft.NET.Test.Sdk" Version="16.8.0" />
        <PackageReference Include="Moq" Version="4.15.2" />
        <PackageReference Include="MSTest.TestAdapter" Version="2.1.2" />
        <PackageReference Include="MSTest.TestFramework" Version="2.1.2" />
        <PackageReference Include="NJsonSchema" Version="10.3.1" />
        <PackageReference Include="System.Security.Permissions" Version="5.0.0" />
        <PackageReference Include="Unity" Version="5.11.9" />
        <PackageReference Include="StyleCop.Analyzers" Version="1.1.118">
            <NoWarn>NU1701</NoWarn>
            <PrivateAssets>all</PrivateAssets>
            <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
        </PackageReference>
        <PackageReference Include="Microsoft.CodeAnalysis.FxCopAnalyzers" Version="3.3.1">
            <PrivateAssets>all</PrivateAssets>
            <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
        </PackageReference>
        <PackageReference Include="RestSharp" Version="106.11.7" />
        <PackageReference Include="AutoFixture" Version="4.14.0" />

        <PackageReference Include="SpecFlow" Version="3.5.14" />
        <PackageReference Include="SpecFlow.MsTest" Version="3.5.14" />
        <PackageReference Include="SpecFlow.Tools.MsBuild.Generation" Version="3.5.14" />
    </ItemGroup>

    <ItemGroup>
        <ProjectReference Include="..\..\Framework\Bellatrix.Allure\Bellatrix.Results.Allure.csproj" />
        <ProjectReference Include="..\..\Framework\Bellatrix.Asserts\Bellatrix.Assertions.csproj" />
        <ProjectReference Include="..\..\Framework\Bellatrix.MSTest\Bellatrix.MSTest.csproj" />
        <ProjectReference Include="..\..\Framework\Bellatrix.Logging\Bellatrix.Logging.csproj" />
        <ProjectReference Include="..\..\Framework\Bellatrix.SpecFlow.API.MSTest\Bellatrix.SpecFlow.API.MSTest.csproj" />
        <ProjectReference Include="..\..\Framework\Bellatrix.SpecFlow.TestExecutionExtensions.API\Bellatrix.SpecFlow.TestExecutionExtensions.API.csproj" />
        <ProjectReference Include="..\..\Framework\Bellatrix.Utilities\Bellatrix.Utilities.csproj" />
        <ProjectReference Include="..\..\Framework\Bellatrix.ServicesCollection\Bellatrix.ServicesCollection.csproj" />
    </ItemGroup>

    <ItemGroup>
        <None Include="..\..\Framework\AutomateThePlanet.licenseheader" Link="AutomateThePlanet.licenseheader" />
    </ItemGroup>

    <ItemGroup>
        <Compile Update="RequestsFeatures.feature.cs">
            <DesignTime>True</DesignTime>
            <AutoGen>True</AutoGen>
            <DependentUpon>RequestsFeatures.feature</DependentUpon>
        </Compile>
    </ItemGroup>

    <ItemGroup>
        <None Update="specflow.json">
            <CopyToOutputDirectory>Always</CopyToOutputDirectory>
        </None>
        <None Update="SpecFlowFeature.feature">
            <Generator>SpecFlowSingleFileGenerator</Generator>
            <LastGenOutput>SpecFlowFeature.feature.cs</LastGenOutput>
        </None>
        <None Update="testFrameworkSettings.Debug.json">
            <CopyToOutputDirectory>Always</CopyToOutputDirectory>
        </None>
        <None Update="testFrameworkSettings.json">
            <CopyToOutputDirectory>Always</CopyToOutputDirectory>
        </None>
        <None Update="testFrameworkSettings.Release.json">
            <CopyToOutputDirectory>Always</CopyToOutputDirectory>
        </None>
    </ItemGroup>

    <ItemGroup>
        <SpecFlowFeatureFiles Update="RequestsFeatures.feature">
            <Generator>SpecFlowSingleFileGenerator</Generator>
            <LastGenOutput>RequestsFeatures.feature.cs</LastGenOutput>
        </SpecFlowFeatureFiles>
    </ItemGroup>

    <Target Name="AfterUpdateFeatureFilesInProject">
        <ItemGroup>
            <Compile Include="**\*.feature.cs" Exclude="@(Compile)" />
        </ItemGroup>
    </Target>

</Project>